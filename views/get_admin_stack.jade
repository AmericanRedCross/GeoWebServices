extends layout

block content
	p
		| Provide either an administrative boundary ID, Level and DataSource, OR pass in a Well Known Text representation of a lat/lon
	form(action='',method='post')
		table.inputTable

			tr
				td
					label(for='uniqueid') Feature Unique ID
				td
					input(id='uniqueid',type='text',value=uniqueid,placeholder='uniqueid',name='uniqueid')

			tr
				td
					label(for='adminlevel') Administrative Level
				td
					input(id='adminlevel',type='text',value=adminlevel,placeholder='0',name='adminlevel')

			tr
				td
					label(for='datasource') Data Source
				td
					input(id='datasource',type='text',value=datasource,placeholder='GADM',name='datasource')

			tr
				td
					label(for='format') Format
				td
					select(id='format',name='format')
						formatlist = [ 'html', 'JSON']
							for item in formatlist
								option #{item}

			tr
				td
					label(for='wkt') Well Known Text (WKT) Geometry
				td
					textarea(id='wkt',placeholder='POINT(85.341 25.811)',name='wkt')
						|#{wkt}

		div(data-role='fieldcontain')   
			input(type='submit',value='Submit',data-transition='fade', data-theme='c')

	
	-if(infoMessage){
		div.infoMessage
			|#{infoMessage}
	-}
	-if(errorMessage){
		div.errorMessage
			|#{errorMessage}
	-}


block sidebar
	.widget
		h1 Results
		.results
			- if (featureCollection){
				-if(featureCollection.features){
					i # records: #{featureCollection.features.length}
					each val, key in featureCollection.features
						div.propertyGroup
							each ival, ikey in val.properties
								-if(ival && ival.coordinates){
									each egval, egkey in ival
										div.geometry #{ikey}: #{egkey}: #{egval}
								-}else{
									div.property #{ikey}: #{ival}
								-}
								
							-if(val.geometry){
								-if(val.geometry.geometries){
									each mgval, mgkey in val.geometry.geometries
										-if(mgval.coordinates){
											div.geometries #{mgval.type}: #{mgval.coordinates}
										-}
								-}else{
									each gval, gkey in val.geometry
										div.geometry geometry: #{gkey}: #{gval}
								-}
							-}
							
				-}else{
					div.propertyGroup No results found
				-}
			-}
			